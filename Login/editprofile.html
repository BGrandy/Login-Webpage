<html>

<head>
    <link rel='stylesheet' href="login.css" />
</head>


<body>

    <div id="dID" class='centeredPrompt' style="height: 500px">
        <div style="padding-top: 10px;">
            <h1 id="hID"></h1>
        </div>
        <div style="margin-bottom: 20; text-align: left; padding-left: 25px;">
            <h3 style="padding-right: 102px;">Name: </h3>
            <input id='nS' />
        </div>
        <div style="margin-bottom: 20; text-align: left; padding-left: 25px;">
            <h3 style="padding-right: 84px;">Address: </h3>
            <input id='aS' />
        </div>
        <div style="margin-bottom: 20; text-align: left; padding-left: 25px;">
            <h3 style="padding-right: 101px;">Email: </h3>
            <input id='eS' />
        </div>
        <div style="margin-bottom: 20; text-align: left; padding-left: 25px;">
            <h3 style="padding-right: 28px;">Phone Number: </h3>
            <input id='pnS' />
        </div>
        <div style="margin-bottom: 20; text-align: left; padding-left: 25px;">
            <h3 style="padding-right: 68px;">Username: </h3>
            <input id='uS' />
        </div>
        <div style="margin-bottom: 20; text-align: left; padding-left: 25px;">
            <h3 style="padding-right: 2px;">Current Password: </h3>
            <input id='cpS' type="password" />
        </div>
        <div style="margin-bottom: 20; text-align: left; padding-left: 25px;">
            <h3 style="padding-right: 32px;">New Password: </h3>
            <input placeholder="Optional" id='npS' type="password" />
        </div>
        <button onclick='saveInfo()' type='submit' id='bID'>
            Save
        </button>
        <div id='errorMSG'>
        </div>
    </div>


    <script type>
        var url = location.href;
        var uName = url.split('=')[1];
        var storageUser = localStorage.getItem('storage');
        storageUser = JSON.parse(storageUser);
        var User = storageUser[uName];

        window.onload = function () {
            document.getElementById("hID").innerHTML = "Edit " + User.username + "'s Profile";
        }

        function saveInfo(event) {
            outerBrackets: {
                innerBrackets: {
                    var iCurrPass = document.getElementById('cpS').value;
                    if (User.password != iCurrPass) break innerBrackets;
                    var iUsername = document.getElementById('uS').value;
                    var iName = document.getElementById('nS').value;
                    var iAddress = document.getElementById('aS').value;
                    var iEmail = document.getElementById('eS').value;
                    var iPhoneNum = document.getElementById('pnS').value;
                    var iNewPass = document.getElementById('npS').value;
                    document.getElementById('dID').style.height = '500px';
                    document.getElementById('errorMSG').innerHTML = ``;
                    ((iNewPass == "" || iNewPass == null) ? User.password = iNewPass : User.password = iCurrPass);
                    storageUser[uName].username = iUsername;
                    storageUser[uName].name = iName;
                    storageUser[uName].address = iAddress;
                    storageUser[uName].email = iEmail;
                    storageUser[uName].phoneNum = iPhoneNum;
                    localStorage.clear();
                    localStorage.setItem('storage', JSON.stringify(storageUser))

                    changePage();
                    break outerBrackets;
                }
                document.getElementById('cpS').value = null;
                document.getElementById('dID').style.height = '520px';
                document.getElementById('errorMSG').innerHTML = `<div style="color: red; margin-top: 5px">Incorrect password.</div>`
            }
        }

        function changePage() {
            var url = location.href;
            var User = url.split('=')[1];
            url = 'profile.html?name=';
            url = url.concat(User);
            location.href = url;
        }

        function checkForNullInput() {


        }

    </script>

</body>

</html>